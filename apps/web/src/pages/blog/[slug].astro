---
import Layout from '../../layouts/Layout.astro';
import { getLiveCollection } from 'astro:content';

const { slug } = Astro.params;

const { entries: posts, error } = await getLiveCollection('posts');

const post = posts?.find(p => p.data.slug === slug);

if (!post) {
  return Astro.redirect('/404');
}
---

<Layout title={post.data.title} description={post.data.seo?.description ?? post.data.excerpt}>
  <article class="max-w-3xl mx-auto">
    <header class="mb-8">
      <h1 class="text-4xl font-bold mb-4">{post.data.title}</h1>
      {post.data.excerpt && (
        <p class="text-xl text-gray-600 mb-4">{post.data.excerpt}</p>
      )}
      <div class="flex gap-4 text-sm text-gray-400">
        {post.data.publishedDate && (
          <time>{new Date(post.data.publishedDate).toLocaleDateString()}</time>
        )}
        {post.data.categories?.length > 0 && (
          <span>{post.data.categories.map((c: any) => c.name).join(', ')}</span>
        )}
      </div>
    </header>
    <div class="prose prose-gray max-w-none">
      <p class="text-gray-500 italic">Rich text rendering bude přidán později.</p>
    </div>
  </article>
</Layout>